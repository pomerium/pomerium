FROM busybox:latest@sha256:e226d6308690dbe282443c8c7e57365c96b5228f0fe7f40731b5d84d37a06839 AS build
RUN touch /config.yaml

FROM gcr.io/distroless/base-debian12:debug-nonroot@sha256:aa786ea4fd24a4fdea4ffdfe5a3540a6ea39ac90d93c4bd4f589d7378706b3fe
ENV AUTOCERT_DIR=/data/autocert
WORKDIR /pomerium
COPY pomerium /bin/
COPY --from=build /config.yaml /pomerium/config.yaml
ENTRYPOINT [ "/bin/pomerium" ]
CMD ["--config","/pomerium/config.yaml"]
